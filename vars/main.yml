---

karaf_logging_properties:
  - { regexp: "^log4j.appender.out=.*$", line: "log4j.appender.out=uk.org.simonsite.log4j.appender.TimeAndSizeRollingAppender" }
  - { regexp: "^log4j.appender.out.layout=.*$", line: "log4j.appender.out.layout=org.apache.log4j.PatternLayout" }
  - { regexp: "^log4j.appender.out.layout.(.)onversionPattern.*$", line: "log4j.appender.out.layout.ConversionPattern=%d{ISO8601} | %-5.5p | %-16.16t | %-32.32c{1} | %X{bundle.id} - %X{bundle.name} - %X{bundle.version} | %m%n" }
  - { regexp: "^log4j.appender.out.file.*$", line: "log4j.appender.out.file=${karaf.data}/log/{{ karaf_service_name }}.log" }
  - { regexp: "^log4j.appender.out.append.*$", line: "log4j.appender.out.append=true" }
  - { regexp: "^log4j.appender.out.(.)atePattern.*$", line: "log4j.appender.out.DatePattern=.yyyy-MM-dd" }
  - { regexp: "^log4j.appender.out.(.)ateRollEnforced.*$", line: "log4j.appender.out.DateRollEnforced=true" }
  - { regexp: "^log4j.appender.out.(.)ompressionAlgorithm.*$", line: "log4j.appender.out.CompressionAlgorithm=GZ" }
  - { regexp: "^log4j.appender.out.(.)axRollFileCount.*$", line: "log4j.appender.out.MaxRollFileCount={{ karaf_log_file_roll_count }}" }
  - { regexp: "^log4j.appender.out.(.)axFileSize.*$", line: "log4j.appender.out.MaxFileSize={{ karaf_log_file_size }}" }
  - { regexp: "log4j.appender.out.(.)axBackupIndex=.*$", line: "#log4j.appender.out.MaxBackupIndex=" }

karaf_wrapper_conf1:
  - { regexp: "^#?set.default.JAVA_HOME.*$", line: "set.default.JAVA_HOME={{ karaf_java_home }}" }
  - { regexp: "^#?wrapper.java.initmemory.*$", line: "wrapper.java.initmemory={{ karaf_java_initial_memory }}" }
  - { regexp: "^#?wrapper.java.maxmemory.*$", line: "wrapper.java.maxmemory={{ karaf_java_max_memory }}" }

karaf_wrapper_default_jvm_options:
  - "-Dfile.encoding=UTF-8"
  - "-XX:MaxPermSize={{ karaf_java_max_perm_memory }}m"
  - "-Djava.io.tmpdir=%KARAF_DATA%/tmp"

karaf_base_configuration:
  - file: "custom.properties"
    params:
      - { prop: "karaf.framework", value: "{{ karaf_osgi_framework|default('_UNDEFINED_') }}" }
  - file: "system.properties"
    params:
      - { prop: "karaf.name", value: "{{ karaf_instance_name }}" }
  - file: "org.apache.karaf.shell.cfg"
    params:
      - { prop: "sshPort", value: "{{ karaf_ssh_port }}" }
      - { prop: "sshHost", value: "{{ karaf_ssh_host }}" }
  - file: "org.apache.karaf.management.cfg"
    params:
      - { prop: "rmiRegistryPort", value: "{{ karaf_rmi_registry_port }}" }
      - { prop: "rmiRegistryHost", value: "{{ karaf_rmi_server_host }}" }
      - { prop: "rmiServerPort", value: "{{ karaf_rmi_server_port }}" }
      - { prop: "rmiServerHost", value: "{{ karaf_rmi_server_host }}" }
      - { prop: "jmxRealm", value: "{{ karaf_rmi_jmx_realm }}" }


karaf_delete_data: 'no'
